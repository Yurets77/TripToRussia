!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):(e=e||self).ReactInputMask=t(e.React)}(this,(function(e){"use strict";var t="default"in e?e.default:e;function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return function(e,t){for(var n=Object.getOwnPropertyNames(t),i=0;i<n.length;i++){var r=n[i],a=Object.getOwnPropertyDescriptor(t,r);a&&a.configurable&&void 0===e[r]&&Object.defineProperty(e,r,a)}}(e,t),e})(e,t)}function r(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}function a(e){return requestAnimationFrame(e)}function o(e){cancelAnimationFrame(e)}function l(e){var t=e.ownerDocument;return t.hasFocus()&&t.activeElement===e}function u(e){return null==e?void 0:e.ownerDocument}function s(e){var t=function(e){var t;return null==(t=u(e))?void 0:t.defaultView}(e);return!!t&&e instanceof t.HTMLElement}function c(t){return e.useCallback((function(){var e=t.current,n="undefined"!=typeof window&&s(e);if(!e||!n)return null;if("INPUT"!==e.nodeName&&(e=e.querySelector("input")),!e)throw new Error("react-input-mask: inputComponent doesn't contain input node");return e}),[t])}function f(t,n){var i,r,u,s,f=e.useRef({start:null,end:null}),h=c(t),g=e.useCallback((function(){return function(e){var t=e.selectionStart,n=e.selectionEnd;return{start:t,end:n,length:n-t}}(h())}),[h]),d=e.useCallback((function(){return f.current}),[]),v=e.useCallback((function(e){var t=h();t&&l(t)&&(!function(e,t,n){void 0===n&&(n=t),e.setSelectionRange(t,n)}(t,e.start,e.end),f.current=g())}),[h,g]),p=e.useCallback((function(){f.current=g()}),[g]),m=(i=p,r=e.useRef(null),u=e.useCallback((function(){null===r.current&&function e(){i(),r.current=a(e)}()}),[i]),s=e.useCallback((function(){o(r.current),r.current=null}),[]),e.useEffect((function(){r.current&&(s(),u())}),[u,s]),e.useEffect(o,[]),[u,s]),P=m[0],k=m[1];return e.useLayoutEffect((function(){if(n){var e=h();return e.addEventListener("focus",P),e.addEventListener("blur",k),l(e)&&P(),function(){e.removeEventListener("focus",P),e.removeEventListener("blur",k),k()}}})),{getSelection:g,getLastSelection:d,setSelection:v}}function h(t,n){var i=e.useRef(),r=f(i,n),a=r.getSelection,o=r.getLastSelection,l=r.setSelection,u=function(t,n){var i=c(t),r=e.useRef(n);return{getValue:e.useCallback((function(){return i().value}),[i]),getLastValue:e.useCallback((function(){return r.current}),[]),setValue:e.useCallback((function(e){r.current=e;var t=i();t&&(t.value=e)}),[i])}}(i,t),s=u.getValue,h=u.getLastValue,g=u.setValue;return{inputRef:i,getInputState:function(){return{value:s(),selection:a()}},getLastInputState:function(){return{value:h(),selection:o()}},setInputState:function(e){var t=e.value,n=e.selection;g(t),l(n)}}}var g=function(e,t,n,i,r,a,o,l){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[n,i,r,a,o,l],c=0;(u=new Error(t.replace(/%s/g,(function(){return s[c++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}},d=["disabled","onBlur","onChange","onFocus","onMouseDown","readOnly","value"],v={9:/[0-9]/,a:/[A-Za-z]/,"*":/[A-Za-z0-9]/};var p=function(e){var t=this;this.isCharacterAllowedAtPosition=function(e,n){var i=t.maskOptions.maskPlaceholder;return!!t.isCharacterFillingPosition(e,n)||!!i&&i[n]===e},this.isCharacterFillingPosition=function(e,n){var i=t.maskOptions.mask;if(!e||n>=i.length)return!1;if(!t.isPositionEditable(n))return i[n]===e;var r=i[n];return new RegExp(r).test(e)},this.isPositionEditable=function(e){var n=t.maskOptions,i=n.mask,r=n.permanents;return e<i.length&&-1===r.indexOf(e)},this.isValueEmpty=function(e){return e.split("").every((function(e,n){return!t.isPositionEditable(n)||!t.isCharacterFillingPosition(e,n)}))},this.isValueFilled=function(e){return t.getFilledLength(e)===t.maskOptions.lastEditablePosition+1},this.getDefaultSelectionForValue=function(e){var n=t.getFilledLength(e),i=t.getRightEditablePosition(n);return{start:i,end:i}},this.getFilledLength=function(e){return function(e,t){for(var n=e.length-1;n>=0;n--){if(t(e[n],n))return n}return-1}(e.split(""),(function(e,n){return t.isPositionEditable(n)&&t.isCharacterFillingPosition(e,n)}))+1},this.getStringFillingLengthAtPosition=function(e,n){return e.split("").reduce((function(e,n){return t.insertCharacterAtPosition(e,n,e.length)}),function(e,t){void 0===t&&(t=1);for(var n="",i=0;i<t;i++)n+=e;return n}(" ",n)).length-n},this.getLeftEditablePosition=function(e){for(var n=e;n>=0;n--)if(t.isPositionEditable(n))return n;return null},this.getRightEditablePosition=function(e){for(var n=t.maskOptions.mask,i=e;i<n.length;i++)if(t.isPositionEditable(i))return i;return null},this.formatValue=function(e){var n=t.maskOptions,i=n.maskPlaceholder,r=n.mask;if(!i){for(e=t.insertStringAtPosition("",e,0);e.length<r.length&&!t.isPositionEditable(e.length);)e+=r[e.length];return e}return t.insertStringAtPosition(i,e,0)},this.clearRange=function(e,n,i){if(!i)return e;var r=n+i,a=t.maskOptions,o=a.maskPlaceholder,l=a.mask,u=e.split("").map((function(e,i){var a=t.isPositionEditable(i);return!o&&i>=r&&!a?"":i<n||i>=r?e:a?o?o[i]:"":l[i]})).join("");return t.formatValue(u)},this.insertCharacterAtPosition=function(e,n,i){var r=t.maskOptions,a=r.mask,o=r.maskPlaceholder;if(i>=a.length)return e;var l=t.isCharacterAllowedAtPosition(n,i),u=t.isPositionEditable(i),s=t.getRightEditablePosition(i),c=o&&s?n===o[s]:null,f=e.slice(0,i);!l&&u||(e=f+(l?n:a[i]));return l||u||c||(e=t.insertCharacterAtPosition(e,n,i+1)),e},this.insertStringAtPosition=function(e,n,i){var r=t.maskOptions,a=r.mask,o=r.maskPlaceholder;if(!n||i>=a.length)return e;var l=n.split(""),u=t.isValueFilled(e)||!!o,s=e.slice(i);if(e=l.reduce((function(e,n){return t.insertCharacterAtPosition(e,n,e.length)}),e.slice(0,i)),u)e+=s.slice(e.length-i);else if(t.isValueFilled(e))e+=a.slice(e.length).join("");else{e=s.split("").filter((function(e,n){return t.isPositionEditable(i+n)})).reduce((function(e,n){var i=t.getRightEditablePosition(e.length);return null===i?e:(t.isPositionEditable(e.length)||(e+=a.slice(e.length,i).join("")),t.insertCharacterAtPosition(e,n,e.length))}),e)}return e},this.processChange=function(e,n){var i=t.maskOptions,r=i.mask,a=i.prefix,o=i.lastEditablePosition,l=e.value,u=e.selection,s=n.value,c=n.selection,f=l,h="",g=0,d=0,v=Math.min(c.start,u.start);if(u.end>c.start?(h=f.slice(c.start,u.end),d=(g=t.getStringFillingLengthAtPosition(h,v))?c.length:0):f.length<s.length&&(d=s.length-f.length),f=s,d){if(1===d&&!c.length)v=c.start===u.start?t.getRightEditablePosition(u.start):t.getLeftEditablePosition(u.start);f=t.clearRange(f,v,d)}return f=t.insertStringAtPosition(f,h,v),(v+=g)>=r.length?v=r.length:v<a.length&&!g?v=a.length:v>=a.length&&v<o&&g&&(v=t.getRightEditablePosition(v)),{value:f=t.formatValue(f),enteredString:h,selection:{start:v,end:v}}},this.maskOptions=function(e){var t=e.mask,n=e.maskPlaceholder,i=[];if(!t)return{maskPlaceholder:null,mask:null,prefix:null,lastEditablePosition:null,permanents:[]};if("string"==typeof t){var r=!1,a="";t.split("").forEach((function(e){r||"\\"!==e?(!r&&v[e]||i.push(a.length),a+=e,r=!1):r=!0})),t=a.split("").map((function(e,t){return-1===i.indexOf(t)?v[e]:e}))}else t.forEach((function(e,t){"string"==typeof e&&i.push(t)}));n&&(n=1===n.length?t.map((function(e,t){return-1!==i.indexOf(t)?e:n})):n.split(""),i.forEach((function(e){n[e]=t[e]})),n=n.join(""));for(var o=i.filter((function(e,t){return e===t})).map((function(e){return t[e]})).join(""),l=t.length-1;-1!==i.indexOf(l);)l--;return{maskPlaceholder:n,prefix:o,mask:t,lastEditablePosition:l,permanents:i}}(e)},m=["children"],P=function(e){var n,a;function o(){return e.apply(this,arguments)||this}return a=e,(n=o).prototype=Object.create(a.prototype),n.prototype.constructor=n,i(n,a),o.prototype.render=function(){var e=this.props,n=e.children,i=r(e,m);return t.cloneElement(n,i)},o}(t.Component),k=["alwaysShowMask","children","mask","maskPlaceholder","beforeMaskedStateChange"],b=e.forwardRef((function(i,o){var s=i.alwaysShowMask,f=i.children,v=i.mask,m=i.maskPlaceholder,b=i.beforeMaskedStateChange,E=r(i,k);!function(e){var t=e.mask,n=e.maskPlaceholder;t&&n&&1!==n.length&&n.length!==t.length&&g(!1)}(i);var S,C,y=new p({mask:v,maskPlaceholder:m}),w=!!v,O=!E.disabled&&!E.readOnly,V=null!==i.value&&void 0!==i.value,F=(S=w,C=e.useRef(),e.useEffect((function(){C.current=S})),C.current),L=h(function(e){return""+e}((V?i.value:i.defaultValue)||""),w),R=L.inputRef,A=L.getInputState,x=L.setInputState,M=L.getLastInputState,j=c(R);if(w&&V){var D=j(),I=D&&l(D)||s||i.value?y.formatValue(i.value):i.value;b&&(I=b({nextState:{value:I,selection:{start:null,end:null}}}).value),x(n({},M(),{value:I}))}var T=M(),B=T.selection,N=T.value;e.useLayoutEffect((function(){if(w){var e=l(j()),t=B,i=A(),r=n({},i);if(!V){var a=i.value,o=y.formatValue(a),u=y.isValueEmpty(o);!u||e||s?r.value=o:u&&!e&&(r.value="")}e&&!F?r.selection=y.getDefaultSelectionForValue(r.value):V&&e&&t&&null!==t.start&&null!==t.end&&(r.selection=t),b&&(r=b({currentState:i,nextState:r})),x(r)}}));var q=n({},E,{onFocus:function(e){R.current=e.target;var t=A().value;if(w&&!y.isValueFilled(t)){var n=y.formatValue(t),r=y.getDefaultSelectionForValue(n),o={value:n,selection:r};b&&(n=(o=b({currentState:A(),nextState:o})).value,r=o.selection),x(o),n!==t&&i.onChange&&i.onChange(e),a((function(){x(M())}))}i.onFocus&&i.onFocus(e)},onBlur:function(e){var t=A().value,n=M().value;if(w&&!s&&y.isValueEmpty(n)){var r="",a={value:r,selection:{start:null,end:null}};b&&(r=(a=b({currentState:A(),nextState:a})).value),x(a),r!==t&&i.onChange&&i.onChange(e)}i.onBlur&&i.onBlur(e)},onChange:w&&O?function(e){var t=A(),n=M(),r=y.processChange(t,n);b&&(r=b({currentState:t,previousState:n,nextState:r})),x(r),i.onChange&&i.onChange(e)}:i.onChange,onMouseDown:w&&O?function(e){var t=j(),r=A().value,a=u(t);if(!l(t)&&!y.isValueFilled(r)){var o=e.clientX,s=e.clientY,c=(new Date).getTime();a.addEventListener("mouseup",(function e(i){if(a.removeEventListener("mouseup",e),l(t)){var r=Math.abs(i.clientX-o),u=Math.abs(i.clientY-s),f=Math.max(r,u),h=(new Date).getTime()-c;if(f<=10&&h<=200||f<=5&&h<=300){var g=M(),d=n({},g,{selection:y.getDefaultSelectionForValue(g.value)});x(d)}}}))}i.onMouseDown&&i.onMouseDown(e)}:i.onMouseDown,ref:function(e){R.current=e,!function(e){return"function"==typeof e}(o)?null!==o&&"object"==typeof o&&(o.current=e):o(e)},value:w&&V?N:i.value});return f?(function(e,t){d.filter((function(n){return null!=t.props[n]&&t.props[n]!==e[n]})).length&&g(!1)}(i,f),t.createElement(P,q,f)):t.createElement("input",q)}));return b.displayName="InputMask",b.defaultProps={alwaysShowMask:!1,maskPlaceholder:"_"},b}));
